{"ast":null,"code":"import _regeneratorRuntime from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{Component}from'react';import'./gps.css';import Chip from'@material-ui/core/Chip';import Button from'@material-ui/core/Button';import Grid from'@material-ui/core/Grid';import Typography from'@material-ui/core/Typography';var GPS=/*#__PURE__*/function(_Component){_inherits(GPS,_Component);var _super=_createSuper(GPS);function GPS(props){var _this;_classCallCheck(this,GPS);_this=_super.call(this,props);_this._isMounted=false;_this.gpsdataresponse=function(){var _this$state=_this.state,gpsData=_this$state.gpsData,isGPSLoading=_this$state.isGPSLoading,isParamEmpty=_this$state.isParamEmpty;var gpsList=[{'name':'Asset DB ID','id':'assetdbid'},{'name':'Firmware','id':'firmware'},{'name':'Gps DB ID','id':'gpsdbid'},{'name':'Last Phone Home','id':'lastcallhome'},{'name':'Last Inspection Date','id':'lastinspectiondate'},{'name':'Last Position Date','id':'lastpositiondate'},{'name':'Sim Card Number','id':'scid'}];// console.log('functin working')\nif(gpsData[0]===undefined){// console.log('No gps data')\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[isGPSLoading&&/*#__PURE__*/_jsx(\"span\",{children:\" Loading.... \"}),!isGPSLoading&&isParamEmpty&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{align:\"center\",children:\"No gps data \"}),/*#__PURE__*/_jsx(Button,{align:\"right\",onClick:function onClick(){return _this.fetchGpsData();},color:\"primary\",children:\"Get gps\"})]})]});}else{var getGPSDATA=gpsData[0];// console.log(getGPSDATA,getGPSDATA[0])\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Grid,{container:true,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:true,children:/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"subtitle1\",children:\"GPS ID\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"h6\",children:getGPSDATA['gpsid']})}),/*#__PURE__*/_jsx(\"br\",{})]}),gpsList.map(function(i){// console.log('its working')\nreturn/*#__PURE__*/_jsxs(Grid,{className:\"gps-grid-container\",container:true,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:true,children:/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",variant:\"body2\",children:i.name})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",variant:\"body2\",children:getGPSDATA[i.id]===null||getGPSDATA[i.id]===''?'-':getGPSDATA[i.id]})})]},i.id);})]});}};_this.state={data:_this.props.data,gpsData:[],isGPSLoading:true,isComponentMounted:true,isParamEmpty:false};return _this;}_createClass(GPS,[{key:\"componentDidMount\",value:function componentDidMount(){this._isMounted=true;this.fetchGpsData();this.setState({isComponentMounted:true});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;this.setState({isComponentMounted:false});}},{key:\"fetchGpsData\",value:function(){var _fetchGpsData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state2,_this$state2$data,_this$state2$data$id,id,_this$state2$data$gps,gpsid,account,hashed,isComponentMounted,bodyData,makeRequest,getGpsData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// console.log('fetching gps...')\n_this$state2=this.state,_this$state2$data=_this$state2.data,_this$state2$data$id=_this$state2$data.id,id=_this$state2$data$id===void 0?null:_this$state2$data$id,_this$state2$data$gps=_this$state2$data.gpsid,gpsid=_this$state2$data$gps===void 0?null:_this$state2$data$gps,account=_this$state2$data.account,hashed=_this$state2$data.hashed,isComponentMounted=_this$state2.isComponentMounted;this.setState({gpsData:[]});console.log('fetching.. ',gpsid);if(!(!isComponentMounted||gpsid===null)){_context.next=8;break;}// console.log(`GPS :- Either Component unmounted or gps null mouted==>${isComponentMounted} gps==> ${gpsid}` )\nthis.setState({isGPSLoading:false,isParamEmpty:true});return _context.abrupt(\"return\");case 8:bodyData={'params':{'id':id,'gpsid':gpsid,'account':account,'hashed':hashed}};_context.next=11;return fetch('/gpsunit',{method:'POST',body:JSON.stringify(bodyData),headers:{'Content-Type':'application/json'}});case 11:makeRequest=_context.sent;_context.next=14;return makeRequest.json();case 14:getGpsData=_context.sent;// console.log(getManiData)\nif(makeRequest.status===200&&this._isMounted){if(getGpsData.error){console.log('Error in server bud');this.setState({isGPSLoading:false});}else{// console.log(getGpsData)\nthis.setState({gpsData:getGpsData.gpsdata});}}else{// console.log(`Error after 200 or comp unmounted. is COMP mouted? ====> ${isComponentMounted}`)\nthis.setSate({isGPSLoading:false});}case 16:return _context.abrupt(\"return\",'Done');case 17:case\"end\":return _context.stop();}}},_callee,this);}));function fetchGpsData(){return _fetchGpsData.apply(this,arguments);}return fetchGpsData;}()},{key:\"render\",value:function render(){var _this$state3=this.state,gpsData=_this$state3.gpsData,isGPSLoading=_this$state3.isGPSLoading,isComponentMounted=_this$state3.isComponentMounted;console.log('GPS :- ',this);// console.log(`GPS:${gpsData}, is GPs loading?${gpsLoading}, is comp mounted?${isComponentMounted}`)\nreturn/*#__PURE__*/_jsx(\"div\",{children:this.gpsdataresponse()});}}]);return GPS;}(Component);export{GPS as default};","map":{"version":3,"sources":["/Users/othome/Desktop/projects/zonar/zpeek/src/components/asset-content/mani/gps/gps.js"],"names":["React","Component","Chip","Button","Grid","Typography","GPS","props","_isMounted","gpsdataresponse","state","gpsData","isGPSLoading","isParamEmpty","gpsList","undefined","fetchGpsData","getGPSDATA","map","i","name","id","data","isComponentMounted","setState","gpsid","account","hashed","console","log","bodyData","fetch","method","body","JSON","stringify","headers","makeRequest","json","getGpsData","status","error","gpsdata","setSate"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport './gps.css';\nimport Chip from '@material-ui/core/Chip';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\n\n\nexport default class GPS extends Component {\n\t_isMounted = false;\t\t\n\tconstructor(props){\n\tsuper(props)\n\tthis.state = {\n\t  data : this.props.data,\n\t  gpsData : [],\n\t  isGPSLoading : true,\n\t  isComponentMounted : true,\n\t  isParamEmpty : false\n\t}\n\t}\n\n  componentDidMount(){\n  \tthis._isMounted = true;\n  \tthis.fetchGpsData()\n  \tthis.setState({isComponentMounted : true})\n  }\n\n  componentWillUnmount(){\n  \tthis._isMounted = false;\n  \tthis.setState({isComponentMounted : false})\n  }\n\n\n  async fetchGpsData() {\n\t// console.log('fetching gps...')\n\tconst { data : { id=null, gpsid=null, account, hashed }, isComponentMounted} = this.state\n\tthis.setState({gpsData : [] })\n\t\tconsole.log('fetching.. ', gpsid)\n\n\tif ( !isComponentMounted || gpsid === null ){\n\t\t// console.log(`GPS :- Either Component unmounted or gps null mouted==>${isComponentMounted} gps==> ${gpsid}` )\n\t\tthis.setState({isGPSLoading: false, isParamEmpty : true})\n\t\treturn;\n\t}else{\n\t\tlet bodyData = {\n\t\t'params': {\n\t\t\t'id': id,\n\t\t\t'gpsid': gpsid,\n\t\t\t'account': account, \n\t\t\t'hashed': hashed\n\t\t\t}}\n\t\tconst makeRequest = await fetch('/gpsunit', {\n\t        method: 'POST',\n\t        body: JSON.stringify(bodyData),\n\t        headers: {'Content-Type': 'application/json'}\n\t    })\n\n\t    // console.log('Status',makeRequest)\n\t\tconst getGpsData = await makeRequest.json()\n\t\t// console.log(getManiData)\n\n\t\tif (makeRequest.status === 200 && this._isMounted ) {\n\t\t\tif (getGpsData.error) {\n\t\t\t\tconsole.log('Error in server bud')\n\t\t\t\tthis.setState({isGPSLoading : false})\n\t\t\t}else{\n\t\t\t\t// console.log(getGpsData)\n\t\t\t\tthis.setState({gpsData : getGpsData.gpsdata})\n\t\t\t}\n\t\t}else{\n\t\t\t// console.log(`Error after 200 or comp unmounted. is COMP mouted? ====> ${isComponentMounted}`)\n\t\t\tthis.setSate({isGPSLoading: false})\n\t\t}\n\t}\n\treturn 'Done'\n\t}\n\n\tgpsdataresponse = ()=>{\n\t\tconst {gpsData, isGPSLoading, isParamEmpty} = this.state\n  \t\tconst gpsList =  [\n\t  \t\t{\n\t  \t\t\t'name':'Asset DB ID',\n\t\t\t\t'id':'assetdbid'\n\t\t\t}, {\n\t\t\t\t'name':'Firmware',\n\t\t\t\t'id':'firmware'\n\t\t\t}, {\n\t\t\t\t'name':'Gps DB ID',\n\t\t\t\t'id':'gpsdbid'\n\t  \t\t},{\n\t  \t\t\t'name': 'Last Phone Home',\n\t  \t\t\t'id': 'lastcallhome'\n\t  \t\t},{\n\t  \t\t\t'name': 'Last Inspection Date',\n\t  \t\t\t'id': 'lastinspectiondate'\n\t  \t\t},{\n\t  \t\t\t'name': 'Last Position Date',\n\t  \t\t\t'id': 'lastpositiondate'\n\t  \t\t},{\n\t  \t\t\t'name': 'Sim Card Number',\n\t  \t\t\t'id': 'scid'\n\t  \t\t}\n  \t\t]\n  \t\t// console.log('functin working')\n\n\n  \t\tif (gpsData[0] === undefined) {\n  \t\t\t// console.log('No gps data')\n  \t\t\treturn(\n  \t\t\t\t<div>\n  \t\t\t\t\t{ isGPSLoading && <span> Loading.... </span> }\n\t  \t\t\t\t{ !isGPSLoading && isParamEmpty &&\n\t  \t\t\t\t\t<div>\n\t\t  \t\t\t\t\t<Typography align='center'>No gps data </Typography>\n\t\t  \t\t\t\t\t<Button align='right' onClick={()=> this.fetchGpsData()} color=\"primary\">Get gps</Button>\n\t  \t\t\t\t\t</div>\n\t  \t\t\t\t}\n  \t\t\t\t</div>\n  \t\t\t\t)\n  \t\t}else{\n  \t\t\tconst getGPSDATA = gpsData[0]\n  \t\t\t// console.log(getGPSDATA,getGPSDATA[0])\n  \t\t\treturn (\n  \t\t\t\t<div>\n\t  \t\t\t\t<Grid container alignItems=\"center\">\n\t\t\t\t\t\t<Grid item xs>\n\t\t\t\t\t\t\t<Typography gutterBottom variant=\"subtitle1\">\n\t\t\t\t\t\t\t\tGPS ID\n\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t</Grid>\n\t\t\t        <Grid item>\n\t\t\t            <Typography gutterBottom variant=\"h6\">\n\t\t\t              {getGPSDATA['gpsid']}\n\t\t\t            </Typography>\n\t\t\t        </Grid>\n\t\t\t\t     <br/>\n\n\t\t\t\t    </Grid>\n\t  \t\t\t\t{gpsList.map(i=>{\n\t  \t\t\t\t// console.log('its working')\n\t  \t\t\t\treturn(\n\t\t\t\t\t\t<Grid className='gps-grid-container' key={i.id} container alignItems=\"center\">\n\t\t\t\t\t\t\t<Grid item xs>\n\t\t\t\t\t\t\t  <Typography color=\"textSecondary\" variant=\"body2\">\n\t\t\t\t\t\t\t  \t{i.name}\n\t\t\t\t\t\t\t  </Typography>\n\t\t\t\t\t\t\t</Grid>\t\t\t          \n\t\t\t\t\t\t\t<Grid item>\n\t\t\t\t\t\t\t  <Typography color=\"textSecondary\" variant=\"body2\">\n\t\t\t\t\t\t\t  \t{getGPSDATA[i.id] === null || getGPSDATA[i.id] === '' ? '-' : getGPSDATA[i.id]}\n\t\t\t\t\t\t\t  </Typography>\n\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t</Grid>\n\t  \t\t\t \t)\n\t  \t\t\t})}\n  \t\t\t\t</div>\n  \t\t\t)\n  \t\t}\n  \t}\n\n  render(){\n  \tconst {gpsData, isGPSLoading, isComponentMounted} = this.state\n  \tconsole.log('GPS :- ', this)\n  \t// console.log(`GPS:${gpsData}, is GPs loading?${gpsLoading}, is comp mounted?${isComponentMounted}`)\n\n\treturn (\n\t\t<div>\n\t\t\t{ this.gpsdataresponse() }\n\t\t</div>\n\t  );\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}