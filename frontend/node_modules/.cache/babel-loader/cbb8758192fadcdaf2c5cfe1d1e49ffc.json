{"ast":null,"code":"import _regeneratorRuntime from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/othome/Desktop/projects/zonar/zpeek/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{Component}from'react';import Chip from'@material-ui/core/Chip';import'./location.css';var Location=/*#__PURE__*/function(_Component){_inherits(Location,_Component);var _super=_createSuper(Location);function Location(props){var _this;_classCallCheck(this,Location);_this=_super.call(this,props);_this._isMounted=false;_this.state={locationDetails:[],data:_this.props.data,isComponentMounted:true,isLocationLoading:true};return _this;}_createClass(Location,[{key:\"componentDidMount\",value:function componentDidMount(){this._isMounted=true;this.fetchManiData();this.setState({isComponentMounted:true});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;console.log('Location COMPONENT UNMOUNTED');this.setState({isComponentMounted:false});}},{key:\"fetchManiData\",value:function(){var _fetchManiData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$state,_this$state$data,_this$state$data$id,id,_this$state$data$gpsi,gpsid,account,hashed,isComponentMounted,bodyData,makeRequest,getLocationData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('fetching location...');this.setState({locationDetails:[]});_this$state=this.state,_this$state$data=_this$state.data,_this$state$data$id=_this$state$data.id,id=_this$state$data$id===void 0?null:_this$state$data$id,_this$state$data$gpsi=_this$state$data.gpsid,gpsid=_this$state$data$gpsi===void 0?null:_this$state$data$gpsi,account=_this$state$data.account,hashed=_this$state$data.hashed,isComponentMounted=_this$state.isComponentMounted;console.log('State Cleared!...........',isComponentMounted);if(!(!isComponentMounted||gpsid===null)){_context.next=9;break;}// console.log(` Location :- Either Component unmounted or gps null mouted?==>${isComponentMounted} gps==> ${gpsid}`)\nthis.setState({isLocationLoading:false});return _context.abrupt(\"return\");case 9:console.log('L :- setting state of Loading to TRUE ');this.setState({isLocationLoading:true});bodyData={'params':{'id':id,'gpsid':gpsid,'account':account,'hashed':hashed}};_context.next=14;return fetch('/location',{method:'POST',body:JSON.stringify(bodyData),headers:{'Content-Type':'application/json'}});case 14:makeRequest=_context.sent;_context.next=17;return makeRequest.json();case 17:getLocationData=_context.sent;console.log('Done making request',getLocationData,isComponentMounted);if(!(makeRequest.status===200&&this._isMounted)){_context.next=23;break;}if(getLocationData.error){console.log('Error in server ',getLocationData.error);this.setState({isLocationLoading:false});}else{if(getLocationData&&isComponentMounted){console.log('Location on the way!');this.setState({locationDetails:getLocationData.locationresponse,isLocationLoading:false});// console.log(getLocationData)\n}else{// this.setState({pathexists : false})\nconsole.log('Error AFTER 200 status on fetch');}}_context.next=25;break;case 23:// console.log(`Error AFTER 200 status on fetch or Component is unmounted... COMP mounted?==>${isComponentMounted}`)\nthis.setSate({gettingMani:false});return _context.abrupt(\"return\");case 25:return _context.abrupt(\"return\",'Done');case 26:case\"end\":return _context.stop();}}},_callee,this);}));function fetchManiData(){return _fetchManiData.apply(this,arguments);}return fetchManiData;}()},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,locationDetails=_this$state2.locationDetails,isLocationLoading=_this$state2.isLocationLoading;var functionn=function functionn(){return _this2.fetchManiData();};console.log(locationDetails);return/*#__PURE__*/_jsxs(\"div\",{children:[isLocationLoading&&/*#__PURE__*/_jsx(\"span\",{children:\" Loading..... \"}),!isLocationLoading&&/*#__PURE__*/_jsxs(\"div\",{children:[\" \",locationDetails.power==='on'?/*#__PURE__*/_jsx(Chip,{className:\"chip-on\",label:\"On\",onClick:functionn}):/*#__PURE__*/_jsx(Chip,{className:\"chip-off\",label:\"Off\"})]})]});}}]);return Location;}(Component);export{Location as default};","map":{"version":3,"sources":["/Users/othome/Desktop/projects/zonar/zpeek/src/components/asset-content/mani/location/location.js"],"names":["React","Component","Chip","Location","props","_isMounted","state","locationDetails","data","isComponentMounted","isLocationLoading","fetchManiData","setState","console","log","id","gpsid","account","hashed","bodyData","fetch","method","body","JSON","stringify","headers","makeRequest","json","getLocationData","status","error","locationresponse","setSate","gettingMani","functionn","power"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Chip from '@material-ui/core/Chip';\nimport './location.css';\n\n\nexport default class Location extends Component{\n\t_isMounted = false;\n\tconstructor (props){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tlocationDetails : [],\n\t\t\tdata : this.props.data,\n\t\t\tisComponentMounted : true,\n\t\t\tisLocationLoading : true\n\t\t}\n\t}\n\n\tcomponentDidMount(){\n\t\tthis._isMounted = true;\n\t\tthis.fetchManiData()\n\t\tthis.setState({isComponentMounted : true})\n\t}\n\n\n\tcomponentWillUnmount(){\n\t\tthis._isMounted = false;\n\t\tconsole.log('Location COMPONENT UNMOUNTED')\n\t\tthis.setState({isComponentMounted : false})\n    }\n\n  \tasync fetchManiData() {\n\n\t\tconsole.log('fetching location...')\n\t\tthis.setState({locationDetails : []})\n\t\tconst { data : { id=null, gpsid=null, account, hashed }, isComponentMounted} = this.state\n\n\n\t\tconsole.log('State Cleared!...........',isComponentMounted)\n\t\t\n\n\t\tif (!isComponentMounted || gpsid === null){\n\t\t\t// console.log(` Location :- Either Component unmounted or gps null mouted?==>${isComponentMounted} gps==> ${gpsid}`)\n\t\t\tthis.setState({isLocationLoading: false})\n\t\t\treturn;\n\t\t}else{\n\t\t\tconsole.log('L :- setting state of Loading to TRUE ')\n\t\t\tthis.setState({isLocationLoading : true})\n\t\t\tlet bodyData = {\n\t\t\t'params': {\n\t\t\t\t'id': id,\n\t\t\t\t'gpsid': gpsid,\n\t\t\t\t'account':account,\n\t\t\t\t'hashed':hashed\n\t\t\t\t}}\n\t\t\tconst makeRequest = await fetch('/location', {\n\t\t        method: 'POST',\n\t\t        body: JSON.stringify(bodyData),\n\t\t        headers: {'Content-Type': 'application/json'}\n\t\t    })\n\t\t    // console.log('End',makeRequest)\n\t\t\tconst getLocationData = await makeRequest.json()\n\t\t\tconsole.log('Done making request',getLocationData, isComponentMounted)\n\n\n\t\t\tif (makeRequest.status === 200 && this._isMounted ) {\n\t\t\t\tif (getLocationData.error) {\n\t\t\t\t\tconsole.log('Error in server ',getLocationData.error )\n\t\t\t\t\tthis.setState({isLocationLoading : false})\n\t\t\t\t}else{\n\t\t\t\t\tif (getLocationData && isComponentMounted) {\n\t\t\t\t\t\tconsole.log('Location on the way!')\n\t\t\t\t\t\tthis.setState({locationDetails : getLocationData.locationresponse, isLocationLoading : false})\n\t\t\t\t\t\t// console.log(getLocationData)\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// this.setState({pathexists : false})\n\t\t\t\t\t\tconsole.log('Error AFTER 200 status on fetch')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// console.log(`Error AFTER 200 status on fetch or Component is unmounted... COMP mounted?==>${isComponentMounted}`)\n\t\t\t\tthis.setSate({gettingMani: false})\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\treturn 'Done'\n\t}\n\n\trender(){\n\n\t\tconst {locationDetails, isLocationLoading} = this.state\n\t\tconst functionn = ()=> this.fetchManiData()\n\t\tconsole.log(locationDetails)\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t{ isLocationLoading && <span> Loading..... </span> }\n\t\t\t\t{!isLocationLoading &&\n\t\t\t\t\t<div> {locationDetails.power === 'on' ? <Chip className='chip-on' label='On' onClick={functionn} /> : <Chip className='chip-off' label='Off'/> }</div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)}\n}"]},"metadata":{},"sourceType":"module"}